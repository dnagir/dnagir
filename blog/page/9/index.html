
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Art Of Programming</title>
  <meta name="author" content="Dmytrii Nagirniak">

  
  <meta name="description" content="I created couple of controllers that provide some predefined functionality. All I needed is just to inherit from them. Then I decided to move them &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ApproachE.com/blog/page/9">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/DmitriyNagirnyak" rel="alternate" title="Art Of Programming" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-17928352-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Art Of Programming</a></h1>
  
    <h2>musings by Dmytrii Nagirniak</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/DmitriyNagirnyak" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:ApproachE.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/about/">About</a></li>
  <li><a href="/blog/archives/">Blog</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/reusing-controller-without-inheritance/">Reusing Controller Without Inheritance</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-01-08T12:41:00+11:00" pubdate data-updated="true">Jan 8<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
I created couple of controllers that provide some predefined functionality. All I needed is just to inherit from them. Then I decided to move them in a separate library so I would be able to reuse it in other projects. But then I faced a problem. Controllers of my project are forced to be inherited from those ones.<br />
Thou I don&#8217;t have a problem with it, I additionally want every controller to have more functionality in it. You know, we always want to have something common in all our controllers.<br />
If .NET would support <a href="http://en.wikipedia.org/wiki/Multiple_inheritance" target="_blank">multiple inheritance</a> it would not be a problem at all.<br />
So what I really need in my project is:<br />
<ol>
<li>Be able to inherit from any controller in.</li>
<li>Have additional functionality in any controller.</li>
<li>Have NO code duplicates.</li>
</ol>
<br />
Again. If we inherit - we cannot have common ADDITIONAL functionality (except the inherited one) and we&#8217;ll have to duplicate all the code needed in each controller (it seems so at first glance).<br />
But it is not the case if the base controller supports extensibility. I remembered about <a href="http://www.castleproject.org/MonoRail/documentation/trunk/advanced/dynactions.html" target="_blank">IDynamicActions</a> but it&#8217;s not fully what I need. I just need to add common functionality to all controllers without inheritance. DynamicActions reuse actions (which I might need soon but not for now).<br />
Then I remembered <a href="http://ayende.com/Blog/archive/2008/06/04/Review-Umbrella-project.aspx" target="_blank">Umbrella Project Review</a> and it&#8217;s extension points. The idea was good enough for me and I decided to go with it, but in a simplified way.<br />
No more words. The end result is below (sample controllers):<br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;"><span style="color: green;">// Notice CommonControllerExtension and this.Extension</span>
<span style="color: blue;">public</span> <span style="color: blue;">class</span> HomeController : AbstractBaseController&lt;CommonControllerExtension&gt; {
    <span style="color: blue;">public</span> ActionResult Index() {
        ViewData[<span style="color: #006080;">"Username"</span>] = Extension.User.Username;
        <span style="color: blue;">return</span> View();
    }
}</pre>
</div>
and other controller<br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;"><span style="color: blue;">public</span> <span style="color: blue;">class</span> TopicController : CrudController&lt;Topic, CommonControllerExtension&gt; {
    <span style="color: blue;">protected</span> <span style="color: blue;">override</span> <span style="color: blue;">void</span> PrepareUpdateInfo(UpdateModelInfo updateInfo) {
        updateInfo.Include(<span style="color: #006080;">"Name"</span>, <span style="color: #006080;">"Content"</span>);
    }

    <span style="color: blue;">protected</span> <span style="color: blue;">override</span> IEnumerable&lt;Topic&gt; GetObjectsToList() {
        <span style="color: green;">// Note Extension.WorkSpace!</span>
        <span style="color: blue;">return</span> Extension.WorkSpace.Query().Ocl&lt;Topic&gt;(<span style="color: #006080;">"Topic.allInstances-&gt;orderBy(CreatedDate)"</span>);
    }
}</pre>
</div>
<br />
The point is that we have two completely different controllers: HomeController is inherited from the abstract one; the TopicController is inherited from the CrudController (which is in turn inherited from abstract one). What they have in common is:<br />
<ol>
<li>They explicitly or implicitly inherit from <span style="font-family: Courier New;">AbstractBaseController</span>.</li>
<li>They have the same generic parameter: <span style="font-family: Courier New;">CommonControllerExtension</span>.</li>
</ol>
The second point enables the controller to share common functionality via extension class. It can be single in the whole project or couple of them - your choice.<br />
Here the main thing <span style="font-family: Courier New;">AbstractBaseController</span><br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;"><span style="color: blue;">public</span> <span style="color: blue;">abstract</span> <span style="color: blue;">class</span> AbstractBaseController&lt;TExtendPoint&gt; : Controller <span style="color: blue;">where</span> TExtendPoint : <span style="color: blue;">class</span>, IControllerExtensionPoint&lt;Controller&gt;, <span style="color: blue;">new</span>() {
    
    <span style="color: blue;">private</span> TExtendPoint extension;


    <span style="color: #cc6633;">#region</span> Overriden

    <span style="color: blue;">protected</span> <span style="color: blue;">override</span> <span style="color: blue;">void</span> OnActionExecuting(ActionExecutingContext filterContext) {
        <span style="color: blue;">base</span>.OnActionExecuting(filterContext);
        Extension.OnInit(filterContext);
        OnInit(filterContext);
    }
    <span style="color: blue;">protected</span> <span style="color: blue;">override</span> <span style="color: blue;">void</span> OnActionExecuted(ActionExecutedContext filterContext) {
        <span style="color: blue;">base</span>.OnActionExecuted(filterContext);
        Extension.OnBeforeRender(filterContext);
        OnBeforeRender(filterContext);
    }
    <span style="color: blue;">protected</span> <span style="color: blue;">override</span> <span style="color: blue;">void</span> OnResultExecuted(ResultExecutedContext filterContext) {
        OnEnd(filterContext);
        Extension.OnEnd(filterContext);
        <span style="color: blue;">base</span>.OnResultExecuted(filterContext);
    }

    <span style="color: #cc6633;">#endregion</span>


    
    <span style="color: blue;">public</span> TExtendPoint Extension {
        get {
            <span style="color: blue;">if</span> (extension != <span style="color: blue;">null</span>)
                <span style="color: blue;">return</span> extension;

            <span style="color: green;">// Create an instance with default constructor.</span>
            extension = <span style="color: blue;">new</span> TExtendPoint();
            extension.Controller = <span style="color: blue;">this</span>;
            <span style="color: blue;">return</span> extension;
        }
    }


    <span style="color: green;">/// &lt;summary&gt;</span>
    <span style="color: green;">/// Is called when controller is ready to be initialised with additional info.</span>
    <span style="color: green;">/// &lt;/summary&gt;</span>
    <span style="color: green;">/// &lt;param name="context"&gt;The context.&lt;/param&gt;</span>
    <span style="color: blue;">public</span> <span style="color: blue;">virtual</span> <span style="color: blue;">void</span> OnInit(ActionExecutingContext context) {
    }

    <span style="color: green;">/// &lt;summary&gt;</span>
    <span style="color: green;">/// Is called when controller done it's job and action has been executed, but before the view is rendered.</span>
    <span style="color: green;">/// &lt;/summary&gt;</span>
    <span style="color: green;">/// &lt;param name="context"&gt;The context.&lt;/param&gt;</span>
    <span style="color: blue;">public</span> <span style="color: blue;">virtual</span> <span style="color: blue;">void</span> OnBeforeRender(ActionExecutedContext context) {
    }

    <span style="color: green;">/// &lt;summary&gt;</span>
    <span style="color: green;">/// Is called when the request has been processed and the controller is ready to clean-up the resourse before it gets disposed.</span>
    <span style="color: green;">/// &lt;/summary&gt;</span>
    <span style="color: green;">/// &lt;param name="context"&gt;The context.&lt;/param&gt;</span>
    <span style="color: blue;">public</span> <span style="color: blue;">virtual</span> <span style="color: blue;">void</span> OnEnd(ResultExecutedContext context) {
    }


    <span style="color: green;">/// &lt;summary&gt;</span>
    <span style="color: green;">/// Gets or sets the head title which is ViewData["HeadTitle"]</span>
    <span style="color: green;">/// &lt;/summary&gt;</span>
    <span style="color: green;">/// &lt;value&gt;The head title.&lt;/value&gt;</span>
    <span style="color: blue;">public</span> <span style="color: blue;">string</span> HeadTitle {
        get {
            <span style="color: blue;">return</span> ViewData[<span style="color: #006080;">"HeadTitle"</span>].PropGet(o =&gt; o.ToString());
        }
        set {
            ViewData[<span style="color: #006080;">"HeadTitle"</span>] = <span style="color: blue;">value</span>;
        }
    }

}</pre>
</div>
<br />
And here is the IControllerExtensionPoint interface:<br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;"><span style="color: green;">/// &lt;summary&gt;</span>
<span style="color: green;">/// The interface that allows to provide additional functionality to controller without inheritance.</span>
<span style="color: green;">/// The implementor must have the default constructor.</span>
<span style="color: green;">/// &lt;/summary&gt;</span>
<span style="color: green;">/// &lt;typeparam name="TController"&gt;The type of the controller.&lt;/typeparam&gt;</span>
<span style="color: blue;">public</span> <span style="color: blue;">interface</span> IControllerExtensionPoint&lt;TController&gt; <span style="color: blue;">where</span> TController: Controller {

    <span style="color: green;">/// &lt;summary&gt;</span>
    <span style="color: green;">/// Gets or sets the extending controller.</span>
    <span style="color: green;">/// The setter is automatically invoked just after the instance is created by the controller.</span>
    <span style="color: green;">/// &lt;/summary&gt;</span>
    <span style="color: green;">/// &lt;value&gt;The controller.&lt;/value&gt;</span>
    TController Controller { get; set; }


    <span style="color: green;">/// &lt;summary&gt;</span>
    <span style="color: green;">/// Is called when controller is ready to be initialised with additional info.</span>
    <span style="color: green;">/// &lt;/summary&gt;</span>
    <span style="color: green;">/// &lt;param name="context"&gt;The context.&lt;/param&gt;</span>
    <span style="color: blue;">void</span> OnInit(ActionExecutingContext context);

    <span style="color: green;">/// &lt;summary&gt;</span>
    <span style="color: green;">/// Is called when controller done it's job and action has been executed, but before the view is rendered.</span>
    <span style="color: green;">/// &lt;/summary&gt;</span>
    <span style="color: green;">/// &lt;param name="context"&gt;The context.&lt;/param&gt;</span>
    <span style="color: blue;">void</span> OnBeforeRender(ActionExecutedContext context);

    <span style="color: green;">/// &lt;summary&gt;</span>
    <span style="color: green;">/// Is called when the request has been processed and the controller is ready to clean-up the resourse before it gets disposed.</span>
    <span style="color: green;">/// &lt;/summary&gt;</span>
    <span style="color: green;">/// &lt;param name="context"&gt;The context.&lt;/param&gt;</span>
    <span style="color: blue;">void</span> OnEnd(ResultExecutedContext context);

}</pre>
</div>
Here&#8217;s the sample implementation sample:<br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;"><span style="color: blue;">public</span> <span style="color: blue;">class</span> CommonControllerExtension : IControllerExtensionPoint&lt;Controller&gt;, IEcoServiceProvider {

    <span style="color: #cc6633;">#region</span> IControllerExtensionPoint&lt;Controller&gt; Members

    <span style="color: blue;">public</span> Controller Controller { get; set; }

    <span style="color: blue;">public</span> <span style="color: blue;">void</span> OnInit(ActionExecutingContext context) {
        User = GetTheUserFromSomewhere();
    }

    <span style="color: blue;">public</span> <span style="color: blue;">void</span> OnBeforeRender(ActionExecutedContext context) { 
    }

    <span style="color: blue;">public</span> <span style="color: blue;">void</span> OnEnd(ResultExecutedContext context) {
        <span style="color: blue;">if</span> (ProviderOfWorkSpace != <span style="color: blue;">null</span>)
            ProviderOfWorkSpace.ReleaseWorkSpace();
    }

    <span style="color: #cc6633;">#endregion</span>


    <span style="color: #cc6633;">#region</span> IEcoServiceProvider Members

    <span style="color: blue;">public</span> T GetEcoService&lt;T&gt;() <span style="color: blue;">where</span> T : <span style="color: blue;">class</span> {
        <span style="color: blue;">return</span> WorkSpace.GetEcoService&lt;T&gt;();
    }

    <span style="color: blue;">public</span> <span style="color: blue;">object</span> GetEcoService(Type serviceType) {
        <span style="color: blue;">return</span> WorkSpace.GetEcoService(serviceType);
    }

    <span style="color: #cc6633;">#endregion</span>



    <span style="color: blue;">public</span> IWorkSpaceProvider ProviderOfWorkSpace {
        get;
        set;
    }

    <span style="color: blue;">public</span> IWorkSpace WorkSpace {
        get {
            <span style="color: blue;">if</span> (ProviderOfWorkSpace == <span style="color: blue;">null</span>)
                ProviderOfWorkSpace = <span style="color: blue;">new</span> DefaultWebAppWorkSpaceProvider(() =&gt;
                    <span style="color: blue;">new</span> XmlWorkSpace());
            <span style="color: blue;">return</span> ProviderOfWorkSpace.GetWorkSpace();
        }
    }

    <span style="color: blue;">public</span> TObject GetObjectFromRequest&lt;TObject&gt;(<span style="color: blue;">string</span> name) <span style="color: blue;">where</span> TObject : <span style="color: blue;">class</span>, ILoopBack {
        var vpr = Controller.ValueProvider.GetValue(name);
        <span style="color: blue;">if</span> (vpr == <span style="color: blue;">null</span>)
            <span style="color: blue;">return</span> <span style="color: blue;">null</span>;
        <span style="color: blue;">return</span> WorkSpace.GetObject&lt;TObject&gt;(vpr.AttemptedValue);
    }

    <span style="color: blue;">public</span> User User { get; set; }
}</pre>
</div>
<br />
What we really have achieved here is reusing functionality with avoiding need of no multiple inheritance. It also supports notification via OnInit, OnBeforeRender and OnEnd methods.<br />
The drawback is that each controller must be inherited (implicitly or explicitly) from <span style="font-family: Courier New;">AbstractBaseController</span>. The price I&#8217;m ready to pay because of I inherit from Controller anyway.<br />
Enjoy!</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/onactionexecuting-in-aspnet-mvc-unit/">OnActionExecuting in ASP.NET MVC Unit Tests</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-01-06T15:39:00+11:00" pubdate data-updated="true">Jan 6<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
I&#8217;m doing some initialisation in my application base controller class. Let&#8217;s say for our example that <b>some</b> of our controllers of our application need to have Language object defined. So that every page knows how to be localised.<br />
Let&#8217;s also say we are not sure at this stage how we want to define the language. Possible options are:<br />
<ul>
<li>App/Lang-1/Something/Else.aspx </li>
<li>App/Something/Else.aspx?lang=1 </li>
<li>etc </li>
</ul>
But we just need that Language object now. So the things we need to do are:<br />
<ol>
<li>Add CurrentLanguage property to base controller. </li>
<li>Retrieve CurrentLanguage using my <a href="http://dnagir.blogspot.com/2009/01/aspnet-mvc-request-valueproviderresult.html">GetObjectFromRrequest</a>. </li>
<li>Define the route(s). </li>
</ol>
<br />
No problems at all. All is done:<br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;"><span style="color: blue;">public abstract</span> <span style="color: blue;">class</span> LanguageEnabledController :  BaseAppController {

    <span style="color: blue;">private</span> Language currentLanguage;

    <span style="color: blue;">public</span> Language CurrentLanguage {
        get {
            <span style="color: blue;">if</span> (currentLanguage == <span style="color: blue;">null</span>)
                <span style="color: blue;">throw</span> <span style="color: blue;">new</span> InvalidOperationException(<span style="color: #006080;">"The language should be explicitly assigned. We don't want to provide a fallback."</span>);
            <span style="color: blue;">return</span> currentLanguage;
        }
    }


    <span style="color: blue;">public</span> IWorkSpace WorkSpace {
        get {
            <span style="color: green;">// Stripped...</span>
        }
    }

    <span style="color: blue;">protected</span> <span style="color: blue;">override</span> <span style="color: blue;">void</span> OnActionExecuting(ActionExecutingContext context) {
        <span style="color: blue;">base</span>.OnActionExecuting(filterContext);
        currentLanguage = GetObjectFromRequest&lt;Language&gt;(<span style="color: #006080;">"language"</span>);
        <span style="color: blue;">if</span> (currentLanguage == <span style="color: blue;">null</span>) {
            <span style="color: green;">// Invalid language object or missing URL</span>
            context.Result = RedirectToAction(<span style="color: #006080;">"WrongLanguage"</span>, <span style="color: #006080;">"Error"</span>, <span style="color: blue;">new</span> { language = ValueProvider.GetValue(<span style="color: #006080;">"language"</span>) });
        }
    }


    <span style="color: blue;">public</span> TObject GetObjectFromRequest&lt;TObject&gt;(<span style="color: blue;">string</span> name) <span style="color: blue;">where</span> TObject: <span style="color: blue;">class</span>, ILoopBack {
        var vpr = ValueProvider.GetValue(name);
        <span style="color: blue;">if</span> (vpr == <span style="color: blue;">null</span>)
            <span style="color: blue;">return</span> <span style="color: blue;">null</span>;
        <span style="color: blue;">return</span> WorkSpace.GetObject&lt;TObject&gt;(vpr.AttemptedValue);
    }

}

<span style="color: green;">/*</span>
<span style="color: green;">Also add the route like this:</span>
<span style="color: green;">*/</span>
routes.MapRoute(
    <span style="color: #006080;">"DefaultWithLanguage"</span>,
    <span style="color: #006080;">"Lang-{language}/{controller}/{action}.aspx"</span>,
    <span style="color: blue;">new</span> { controller = <span style="color: #006080;">"Home"</span>, action = <span style="color: #006080;">"Index"</span> }
    );</pre>
</div>
<br />
Ok. This works just great. Every controller now has CurrentLanguage property set correctly. If not, it will give us a message about that. So far so good.<br />
But I spot a problem trying to test my class. Of course, the CurrentLanguage property is never set in tests because of OnActionExecuting is never called.<br />
So what I need now is making this property accessible in tests. I see following options:<br />
<ol>
<li>Reward CurrentLanguage property with a setter. </li>
<li>Inject a service into controllers&#8217; constructor for that.</li>
<li>Simulate OnActnioExecuting.</li>
</ol>
The easiest one is 1st, but we don&#8217;t look for an easy way. I don&#8217;t like this because of CurrentLanguage is really read-only. We&#8217;ll have test code in production. It will also avoid using Routes and binding which I prefer to stay and be part of the test (thou we don&#8217;t actuall test it).<br />
The 2nd is probably the most correct one, but I don&#8217;t want to have service and implementation of it for a single property. I don&#8217;t want to use dependency injection in for now. And I don&#8217;t want to rewrite number of controller for that.<br />
So I choose the 3rd one. Why is it bad? Because of we&#8217;ll have to simulate ControllerInvoker or some part of it. So let&#8217;s get to it.<br />
But we have a problem with this approach: OnContextExecuting is PROTECTED method. We need to do following:<br />
<ol>
<li>Publish OnActionExecuting somehow to make it callable from tests.</li>
<li>Simulate the Controllerinvoker.</li>
</ol>
The 2st step sounds like test-code in productino, but what it really is - just initialisation of the controller. Nothing wrong if it will be public (yes, publishing OnActionExecuting).<br />
So let&#8217;s now put it all together and see the code.<br />
<b>Controller:</b><br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;"><span style="color: blue;">public</span> <span style="color: blue;">class</span> LanguageEnabledController :  BaseAppController {

    <span style="color: blue;">public</span> IWorkSpace WorkSpace {
        get {
            <span style="color: green;">// Stripped</span>
        }
    }

    <span style="color: blue;">protected</span> <span style="color: blue;">override</span> <span style="color: blue;">void</span> OnActionExecuting(ActionExecutingContext filterContext) {
        <span style="color: blue;">base</span>.OnActionExecuting(filterContext);
        InitAppController(filterContext);
    }

    <span style="color: blue;">public</span> <span style="color: blue;">virtual</span> <span style="color: blue;">void</span> InitAppController(ActionExecutingContext context) {
        currentLanguage = GetObjectFromRequest&lt;Language&gt;(<span style="color: #006080;">"language"</span>);
        <span style="color: blue;">if</span> (currentLanguage == <span style="color: blue;">null</span>) {
            <span style="color: green;">// Invalid language object or missing URL</span>
            context.Result = RedirectToAction(<span style="color: #006080;">"WrongLanguage"</span>, <span style="color: #006080;">"Error"</span>, <span style="color: blue;">new</span> { language = ValueProvider.GetValue(<span style="color: #006080;">"language"</span>) });
        }
    }


    <span style="color: blue;">public</span> TObject GetObjectFromRequest&lt;TObject&gt;(<span style="color: blue;">string</span> name) <span style="color: blue;">where</span> TObject: <span style="color: blue;">class</span>, ILoopBack {
        var vpr = ValueProvider.GetValue(name);
        <span style="color: blue;">if</span> (vpr == <span style="color: blue;">null</span>)
            <span style="color: blue;">return</span> <span style="color: blue;">null</span>;
        <span style="color: blue;">return</span> WorkSpace.GetObject&lt;TObject&gt;(vpr.AttemptedValue);
    }

}</pre>
</div>
<br />
<b>And the base test class:</b><br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;"><span style="color: blue;">public</span> <span style="color: blue;">abstract</span> <span style="color: blue;">class</span> BaseControllerTest&lt;TController&gt; <span style="color: blue;">where</span> TController : BaseAppController {

    [TestInitialize]
    <span style="color: blue;">public</span> <span style="color: blue;">void</span> TestInit() {
        SetUp();
    
        var methodParameterValues = <span style="color: blue;">new</span> Dictionary&lt;<span style="color: blue;">string</span>, <span style="color: blue;">object</span>&gt;(StringComparer.OrdinalIgnoreCase);
        var preContext = <span style="color: blue;">new</span> ActionExecutingContext(<span style="color: blue;">this</span>.Controller.ControllerContext, methodParameterValues);
        Controller.InitAppController(preContext);            
    }
    
    <span style="color: blue;">protected</span> <span style="color: blue;">virtual</span> <span style="color: blue;">void</span> SetUp() {           
    }
    
    
    <span style="color: blue;">private</span> TController controller;
    <span style="color: blue;">public</span> TController Controller {
        get {
            <span style="color: blue;">if</span> (controller == <span style="color: blue;">null</span>)
                controller = CreateTestController();
            <span style="color: blue;">return</span> controller;
        }
    }
    <span style="color: blue;">private</span> TController CreateTestController() {
        TController c = Activator.CreateInstance&lt;TController&gt;();
        PrepareTestController(c);
        <span style="color: blue;">return</span> c;
    }
    
    
    IWorkSpace CreateNewSpace() {
        var ws = <span style="color: blue;">new</span> UnitTestsWorkSpace();
        <span style="color: blue;">return</span> ws;
    }
    
    <span style="color: blue;">private</span> <span style="color: blue;">void</span> PrepareTestController(TController c) {
        c.ProviderOfWorkSpace = <span style="color: blue;">new</span> LocalInstanceWorkSpaceProvider(() =&gt; CreateNewSpace());
        c.SetTestContext(); <span style="color: green;">// Extension to set Fake HttpContext</span>
    }
    
    <span style="color: blue;">protected</span> IWorkSpace WorkSpace {
        get {
            <span style="color: blue;">return</span> Controller.WorkSpace;
        }
    }
}</pre>
</div>
<br />
Now we can easily execute tests like in this example:<br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;">[TestClass]
<span style="color: blue;">public</span> <span style="color: blue;">class</span> TestBusinessObjectController : BaseControllerTest&lt;TopicController&gt; {

    Language defaultLanguage;
    Language french;

    <span style="color: blue;">protected</span> <span style="color: blue;">override</span> <span style="color: blue;">void</span> SetUp() {
        french = <span style="color: blue;">new</span> Language(WorkSpace) {
            Code = <span style="color: #006080;">"fr-FR"</span>,
            Name = <span style="color: #006080;">"French"</span>
        };
        defaultLanguage = <span style="color: blue;">new</span> Language(WorkSpace) {
            Code = <span style="color: #006080;">"en-AU"</span>
            Name = <span style="color: #006080;">"Aussie English"</span>
        }
        WorkSpace.UpdateDatabase();
        
        <span style="color: green;">// We need to put the ID of the language into any place that ValueProvider searches in...</span>
        Controller.RouteData.Values[<span style="color: #006080;">"language"</span>] = defaultLanguage.ExternalId(); <span style="color: green;">// Extension to get an ID</span>
    }


    [TestMethod]
    <span style="color: blue;">public</span> <span style="color: blue;">void</span> SelfCheck_ControllerHasLanguageSet() {
        Assert.IsNotNull(Controller.CurrentLanguage);
        Assert.AreEqual(<span style="color: #006080;">"en-AU"</span>, Controller.CurrentLanguage.Code);
    }

    [TestMethod]
    <span style="color: blue;">public</span> <span style="color: blue;">void</span> ListTopicsReturnsAussieTopic() {
        var expected = <span style="color: blue;">new</span> Topic(WorkSpace) {
            Content = <span style="color: #006080;">"Aussie"</span>
            Language = defaultLanguage
        };
        <span style="color: blue;">new</span> Topic(WorkSpace) {
            Content = <span style="color: #006080;">"Who knows"</span>,
            Language = french
        }

        <span style="color: green;">// We expect the Index returs all topics of current language only</span>
        var topic = Controller.Index().ViewData.AsObject&lt;IEnumerable&lt;Topic&gt;&gt;(<span style="color: #006080;">"data"</span>).First();
        Assert.AreEqual(expected, topic);
    }
}</pre>
</div>
<br />
The keys are:<br />
<ul>
<li>public virtual InitAppController.</li>
<li>Using <a href="http://dnagir.blogspot.com/2009/01/aspnet-mvc-request-valueproviderresult.html">GetObjectFromRrequest</a>. </li>
<li>Creating ActionExecutingContext.</li>
</ul>
<br />
Enjoy!</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/aspnet-mvc-request-valueproviderresult/">ASP.NET MVC Request ValueProviderResult: AttemptedValue or RawValue</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-01-02T14:21:00+11:00" pubdate data-updated="true">Jan 2<span>nd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
I want to write a small helper to obtain an object from the request. Nothing special except to note that there are <span style="font-family: Courier New;">AttemptedValue</span> and <span style="font-family: Courier New;">RawValue</span> properties of <span style="font-family: Courier New;">ValueProviderResult</span>. Which one should I use for this helper keeping in mind that an ID of an object is always a string. Let&#8217;s see what these props are:<br />
<ul>
<li><span style="font-family: Courier New;">RawValue</span> - first of all this is not always a string.</li>
<br />
<ul>
<li>If it comes from RouteData it can be something else (int).</li>
<li>If it comes from <span style="font-family: Courier New;">Request.Form</span> - it may be array of something (ints).</li>
</ul>
<br />
<li><span style="font-family: Courier New;">AttemptedValue</span> - is just a RawData converted to string using (<span style="font-family: Courier New;">Convert.ToString</span> with culture info). <b>But</b> in case it is obtained from <span style="font-family: Courier New;">Request.Form</span> it is just a poor value of the posted data.</li>
</ul>
So just keep it in mind. For my purpose using <span style="font-family: Courier New;">AttemptedValue</span> looks a bit more logical, so here&#8217;s the method on my controller:<br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;">TObject GetObjectFromRequest&lt;TObject&gt;(<span style="color: blue;">string</span> name) <span style="color: blue;">where</span> TObject: <span style="color: blue;">class</span>, ILoopBack {
    var vpr = ValueProvider.GetValue(name);
    <span style="color: blue;">if</span> (vpr == <span style="color: blue;">null</span>)
        <span style="color: blue;">return</span> <span style="color: blue;">null</span>;
    <span style="color: blue;">return</span> WorkSpace.GetObject&lt;TObject&gt;(vpr.AttemptedValue);
}</pre>
</div>
<br />
Usage sample:<br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;"><span style="color: blue;">public</span> ActionResult DoSomething(MyObject obj) {
  obj.Parent = GetObjectFromRequest&lt;MyParentObject&gt;(<span style="color: #006080;">"parent"</span>);
  <span style="color: blue;">return</span> View(); <span style="color: green;">// Or whatever</span>
}</pre>
</div></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/merry-christmas-and-happy-new-year/">Merry Christmas and Happy New Year</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-12-25T18:29:00+11:00" pubdate data-updated="true">Dec 25<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
Hello everybody,<br />
<br />
I just want to wish you all the Merry Christmass and a Happy New Year.<br />
Let the God be with you through all the next year and on.<br />
Let all your dreams come true.<br />
<br />
All the best to you.</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/apologetic-coder/">The Apologetic Coder</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-12-24T11:23:00+11:00" pubdate data-updated="true">Dec 24<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
Read <a href="http://thedailywtf.com/Articles/The_Apologetic_Coder.aspx" target="_blank">this</a> if the comment below has got your interest :)<br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;"><span style="color: green;">/* This is bad. Reaaly bad. It's a really, really bad hack. If you're an employee of </span>
<span style="color: green;"> * Intertrode Communication, then I'm really, really sorry that you have to maintain</span>
<span style="color: green;"> * this. I was honestly planning on removing this tomorrow, but I've been known to </span>
<span style="color: green;"> * forget things like this. It happens.</span>
<span style="color: green;"> *</span>
<span style="color: green;"> * So here's the thing. I can't seem to figure out why the AccountId variable isn't </span>
<span style="color: green;"> * set. I've looked and looked, but I gotta leave now. Anyway, I've found that I can</span>
<span style="color: green;"> * just grab the AccountID from the debugging logs.  I suppose that to fix it, you'd</span>
<span style="color: green;"> * have to locate where it's clearing out the ID.</span>
<span style="color: green;"> *</span>
<span style="color: green;"> * Again, I'm sorry.</span>
<span style="color: green;"> */</span></pre>
</div>
<br />
I like some comments there:<br />
<blockquote>
<i>At least the code is<b> thoroughly</b> commented!!</i></blockquote>
<blockquote>
<i>Pre-emptive apology. The wave of the future.</i></blockquote>
<blockquote>
<i>I would like to hire this guy. Good laughs garanteed. He can generate new WTFs at a daily basis for team amusement.</i></blockquote>
<blockquote>
<i>So you wondered why you&#8217;re bank&#8217;s online site ran so slow?&nbsp; Now you know!&nbsp; ROFL</i></blockquote>
<blockquote>
<i>At least he was polite! And at least he didn&#8217;t pretend that his solution was any good.</i></blockquote>
<br />
Just curious, where is this <a href="http://www.google.com/search?q=Intertrode+Communication" target="_blank">Intertrode Communication</a> company :)</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Viktor</div>
<div class='content'>
This is the first program code I&#8217;ve understood from the beginning till the end!</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/esent-embed-database-for-windows/">ESENT - Embed Database for Windows</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-12-24T11:06:00+11:00" pubdate data-updated="true">Dec 24<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
I never knew that. But it <a href="http://ayende.com/Blog/archive/2008/12/23/hidden-windows-gems-extensible-storage-engine.aspx" target="_blank">seems</a> Windows has an <a href="http://msdn.microsoft.com/en-us/library/ms684493%28VS.85%29.aspx" target="_blank">Embed database</a> with it which sounds really interesting (no more MsSqlExpress, FireBird etc).<br />
It also has a .NET interface at <a href="http://www.codeplex.com/ManagedEsent" target="_blank">CodePlex</a>.<br />
This sounds interesting, but I&#8217;m not sure how reliable it is and what are the exact features (bugs) of it.<br />
Also when most of the O/R-mapping tools will start supporting it (the ESENT API has already been published for years).<br />
Anyway, I&#8217;ll need to have a look at this type of DB but I&#8217;m a bit skeptical about using it in a real .NET project.</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/svn-monitor/">SVN-Monitor</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-12-18T13:02:00+11:00" pubdate data-updated="true">Dec 18<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<h4>
Description</h4>
<ul>
<li>Perform all your commonly-used svn-actions (update, commit, revert, diff &#8230;) </li>
<li>Keep your source up-to-date with minimum conflicts and manual merges </li>
<li>Browse and search the svn log from your computer while offline (disconnected from the svn repository) </li>
<li>Be constantly aware of your local source modifications, without using any Visual Studio plugin </li>
<li>Keep a local updated mirror of the repository, while not affecting your changes, without the need to commit </li>
<li><b>Monitor</b> the source for certain events </li>
<li>Receive notifications of any kind (balloon popups, tray icons, email, sounds, &#8230;) when certain events occur </li>
</ul>
<h4>
&nbsp;</h4>
<h4>
References</h4>
Main web site: <a href="http://www.svnmonitor.com/" title="http://www.svnmonitor.com">http://www.svnmonitor.com</a><br />
<br />
<h4>
Licensing</h4>
Free (what exactly?)</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/where-tortoisesvn-name-came-from/">Where TortoiseSVN Name Came From?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-12-16T14:59:00+11:00" pubdate data-updated="true">Dec 16<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
I has just been asked that this question. And I haven&#8217;t really known the answer. One supposition that made me smile &#8221;<i>Is it because of it is very slow?</i>&#8221;<a href="http://tortoisesvn.tigris.org/" target="_blank"><img align="right" src="http://upload.wikimedia.org/wikipedia/commons/1/1d/Tortoisesvn_logo_hor468x64.PNG" /></a><br />
Ok, I suspected the <a href="http://tortoisesvn.net/node/61" target="_blank">answer is</a>&#8230;<br />
<blockquote>
<i>The name of the program was fixed when we started, because the CVS counterpart is called </i><a href="http://www.tortoisecvs.org/"><i>TortoiseCVS</i></a><i>.</i></blockquote>
&nbsp; <br />
But I don&#8217;t really see where <a href="http://www.tortoisecvs.org/">TortoiseCVS</a> came from? As <a href="http://en.wikipedia.org/wiki/TortoiseCVS" target="_blank">Wiki says</a>:<a href="http://www.tortoisecvs.org/" target="_blank"><img align="right" src="http://upload.wikimedia.org/wikipedia/en/6/61/TortoiseCVS-Logo.jpeg" /></a><br />
<blockquote>
<i>The name is a pun on the word </i><a href="http://en.wikipedia.org/wiki/Shell_%28computing%29"><i>shell</i></a></blockquote>
Which doesn&#8217;t make a lot of sense for me. So what&#8217;s the truth?</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/9999-available-aspnet-and-sql-server/">99.99% Available ASP.NET and SQL Server Architecture</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-12-16T13:46:00+11:00" pubdate data-updated="true">Dec 16<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
I&#8217;ll summarise a very nice <a href="http://www.codeproject.com/KB/aspnet/ProdArch.aspx">article</a> here:<br />
<a href="http://www.codeproject.com/KB/aspnet/ProdArch/ProdArch.png" target="_blank" title="Open in a new window"><img align="right" alt="Architecture" height="417" src="http://www.codeproject.com/KB/aspnet/ProdArch/ProdArch.png" width="300" /></a>   <br />
<ul>
<li>Always use public <b>firewall </b>and:       <br />
<ul>
<li>only expose 80, 443 ports; </li>
<li>do not open FTP; </li>
<li>do not open file sharing ports; </li>
</ul>
</li>
<li>Use <b>two Ethernet ports</b>: one for to serve external requests, one for local access. </li>
<li>&#8220;Keep your <b>load balancer dead simple</b> – use basic round robin&#8221;. </li>
<li>Each router and firewall has a <b>standby </b>one. </li>
<li>Get moderately powerful Web servers with <b>enough storage</b>. </li>
<li>Run <b>64bit </b>version of Windows. </li>
<li>The whole internal network is fully <b>1Gbit </b>(network cables, routers/switches, NICs etc). </li>
<li><b>Only use VPN</b> to access your server. </li>
<li>Database servers must be the most powerful (<b>RAID 10 </b>Disks, Memory, CPU). </li>
<li>Store Database files on a separate <b>physical</b> disk. </li>
<li>Always <b>perform backup and log shipping</b> to different physical disks, preferably on RAID 1. </li>
<li>Use <b>Windows Clustering </b>for high availability with Storage Area Network. </li>
<li>RAM,<b> lots of RAM</b> for Database servers (2 GB + 60% of MDF size). </li>
<li>Get <b>Dual Path Fiber</b> Channel connection to SAN from your servers. </li>
<li>Have a <b>separate server for moving IIS logs</b> from webserver. </li>
<li>Have a large<b> detachable external storage</b> like External USB drives. </li>
<li>Use<b> fast SCSI RAID 1</b> disks. </li>
<li>Use <b>separate NIC</b> on all servers that is connected to a separate private network via separate switch <b>for bulk operations</b>. </li>
</ul>
Please keep in mind these suggestions are for really heavy duty web applications.</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/use-insertbefore-instead-of-appendchild/">Use insertBefore Instead of appendChild</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-12-16T12:20:00+11:00" pubdate data-updated="true">Dec 16<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
You can get lots of problems when using node.appendChild due to an element may not be allowed to have children. It is especially valid for WYSIWYG editors.<br />
To overcome this just use node.insertBefore which will always succeeds (it seems so at least). It is so just just because of insertBefore add a child to a parent, which already has at least one child and thus is can have children.<br />
Also keeping in mind this constraint:<br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;">existingChild.insertBefore(newChild, <span style="color: blue;">null</span><span style="color: green;">/*Feeding FF*/</span>);
Assert.areSame(existingChild.parentNode, newChild.parentNode, <span style="color: #006080;">"children should have the same parent"</span>);
Assert.areSame(root, existingchild.parentNode, <span style="color: #006080;">"[root] should be a parent of [exitingChild]"</span>)</pre>
</div>
We can rewrite our code like:<br />
<div>
<pre style="background-color: #f4f4f4; border-style: none; color: black; font-family: consolas,'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; width: 100%;"><span style="color: green;">/*</span>
<span style="color: green;">* root-|</span>
<span style="color: green;">*      |-&gt;existingChild-|-newChild</span>
<span style="color: green;">*/</span>

<span style="color: green;">// BEFORE:</span>
existingChild.parentNode.appendChild(newChild);

<span style="color: green;">// AFTER:</span>
existingChild.insertBefore(newChild, null);</pre>
</div>
<br />
This is especially useful when you have no idea what existingChild or root can be (as it is in WYSYWYG HTML editors) and seems to be much better and exactly what users need.</div>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/10/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/8/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Dmytrii Nagirniak</h1>
  <img src="/about/me.jpg" title="Dmytrii Nagirniak photo" >
  <ul>
    <li>
      <a href="http://twitter.com/dnagir">Twitter</a>
    </li>
    <li>
      <a href="http://github.com/dnagir">Github</a>
    </li>
    <li>
      <a href="http://au.linkedin.com/in/dmitriynagirnyak">LinkedIn</a>
    </li>
    <li>
      <a href="mailto:d@ApproachE.com?subject=Just saying hi">d@ApproachE.com</a>
    </li>
  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/migrating-from-blogger-to-octopress/">Migrating from Blogger to Octopress</a>
      </li>
    
      <li class="post">
        <a href="/blog/knockoutjs-validations-video/">KnockoutJS Validations Screencast</a>
      </li>
    
      <li class="post">
        <a href="/blog/issues-switching-to-jruby-from-mri-19/">Issues switching to JRuby from MRI 1.9</a>
      </li>
    
      <li class="post">
        <a href="/blog/rails-plugin-with-tested-assets/">Rails Plugin with Tested Assets Screencast</a>
      </li>
    
      <li class="post">
        <a href="/blog/tips-on-usingterminal-in-mac/">Use your Terminal like a Pro</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("dnagir", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/dnagir" class="twitter-follow-button" data-show-count="false">Follow @dnagir</a>
  
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Dmytrii Nagirniak -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'approache';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
